#include "perpustakaan.h"

void load_books(Buku **books, int *count) {
    FILE *file = fopen("data/books.txt", "r");
    if (!file) {
        printf("File books.txt tidak ditemukan. Membuat baru.\n");
        return;
    }
    char line[256];
    *count = 0;
    while (fgets(line, sizeof(line), file)) {
        *books = realloc(*books, (*count + 1) * sizeof(Buku));
        sscanf(line, "%d,%99[^,],%99[^,],%49[^,],%19[^\n]",
               &(*books)[*count].id, (*books)[*count].judul,
               (*books)[*count].penulis, (*books)[*count].kategori, (*books)[*count].status);
        (*count)++;
    }
    fclose(file);
}

void save_books(Buku *books, int count) {
    FILE *file = fopen("data/books.txt", "w");
    for (int i = 0; i < count; i++) {
        fprintf(file, "%d,%s,%s,%s,%s\n", books[i].id, books[i].judul, books[i].penulis, books[i].kategori, books[i].status);
    }
    fclose(file);
}
